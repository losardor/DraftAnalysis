We developed an inexpensive and easy-to-use 3D plant scanner to automate the study of Arabidopsis thaliana’s phyllotaxy


Introduction


The shape of a plant can provide insights into the processes that drive its growth. These processes depend on numerous factors. Some factors are specific to the plant, such as its genetic material, and some are external to the plant, such environmental conditions. [TODO: insert argument on why it is important to study this link] However, studies to link genetic features or environmental conditions to plant traits require the detailed analysis of a large number of plants that have been grown in controlled conditions. 
A study to relate the plants shape to possible factors requires researchers to have access to an inexpensive and easy-to-use phenotyping robot. The robot should be able to scan a minimum of a 100 plants a day, have a small footprint so that it does not require a dedicated space, and cost less than 10 000 euros so that is accessible for individual research projects. It should have an automatic processing pipeline that starts from the sensors data and outputs the relevant plant traits.
We have made good progress in developing such a phenotyping station. In this paper we report on the first version that we have built and on the results we obtained using it in our study of the phyllotaxy (the arrangement of fruits along the stem) of the Arabidopsis thaliana. Our evaluation shows that the scanner is X% faster than a human operator and that the average error on the angles is N°, which is less than the error made by manual measurements. These results are good enough for the large scale study that the RDP lab wants to undertake.
Although we currently use the station indoor in a laboratory setting, some of the design choices we have made stem from a long-term effort to develops robotic tools for crop monitoring on farms. We envision to use the same tools to scan plants in the field and use this data to predict when and where a farmer will have to intervene, for example, by detected plant stress early. We also hope that the in-field 3D scans of the crops may complement the data obtained by research laboratories. Although the outdoor conditions in which the plants grow cannot be controlled, contrary to the conditions in grow chambers, it is possible to collect much larger datasets.
However, to bootstrap this ambitious project on a sound basis we first focus on a concrete study. We started with the phenotyping of the Arabidopsis thaliana in indoor settings. This focus allows us to work in a well-defined context and allows us to validate our analysis results against a large body of published research data. 
More specifically, we are using the 3D scanner to analyse the positions of the flowers along the shoot of A. thaliana. The young plant initially grows a rosette of leaves close to the ground. When the mature plant goes into flowering, its stems shoot up and flowers and fruits develop around the stem in a (mostly) spiral organisation. Between each successive flower there is a small stem. The successive flowers are positioned at different horizontal angles around the stem. On average, the angle between them is 137 degrees. These angles results from an interaction between three zones of stem cells in the apical meristem and the inhibiting effect of auxin in these zones [TODO]. 
The arrangement of the fruits along the stem is not perfect and errors may appear. A common error is the inversion of the angles, where flowers with sequence numbers i=1, 2, 3, 4 at angles of 137° are produced in the order 1, 3, 2, 4 at angles 274°, 223°, and 274°. To understand whether the errors in the phyllotaxis are due to genetic expressions or to other factors, it is necessary to analyse several genetic variations of A. thaliana grown in different conditions. 
The 3D scanner is the first step in the development of the phenotyping station needed for this study. 


The main body of work


The basic scanner consists of hardware and control software. The scanner has a main frame built of aluminium profiles. The frame occupies an area of 1.2m x 1.3m and is 2.2m high.  [DESCRIPTION SCANNER HARDWARE]  The 3D scanner uses off-the-shelf components and runs open source software. [EXPAND] The total cost of the station is around 3000 euro. The task of automatically placing the potted plants in the scanner will be dealt with separately later on. 
We also implemented a first version of the data processing pipeline. The pipeline that takes a series of images of a single A. thaliana plant as input and that provides the list of angles and internode lengths as output. The installation uses the high-resolution RGB images of the plant taken at different angles. The processing pipeline goes through the following sequence of steps. First it computes a mask to isolate the plant in the image from the background. It determines the 3D shape of the plant using the space carving technique. The following step estimates the boundary volume as a mesh structure using XXX. The main skeleton is then obtained using active contours. The minimum spanning tree algorithm reduces the graph to a tree structure.  Finally, the series of successive angles and internodes distances are obtained through the analysis of the tree structure. Each step of the pipeline is documented in detail below. 


Evaluation


The results of the 3D scanner are satisfying. The speed-up of the scanner, compared to manual measurements, is N. The new station significantly increases the number of plants that can be scanned per day. The measurement time for one physical scan (excluding the processing time) is less than two minutes. The subsequent processing time is XX (5? 10?) minutes. Time human operator. EXPAND


We have evaluated the precision of the scanner in two ways. First, we compare the list of angles and internode distance to manual measurements on a set of stabilized “ground-truth” plants. Second, we generated sets of virtual plant images that were produced using a computational model of the A. thaliana. These models provide realistic reconstructions with known properties and provide a base truth against which we can test all the intermediate steps of the scanner. 
The scanner produces results with an error margin less than the error made by a human operator.  EXPAND
We also evaluated the precision of each step of the pipeline using synthetic data produced by a computational model of A. thaliana. EXPAND
Both evaluation strategies are used by incrementally improve the pipeline. 




Discussion


We have successfully made the first step towards an inexpensive, automatic phenotyping station to study the relation between the phyllotaxy of A. thaliana and genetics in detail. 
We will start using it in outdoor situations to evaluate how robust it is.   
We are making all information available online so that the scanner can be built and used by others too. Github, development methodology, forum, ...